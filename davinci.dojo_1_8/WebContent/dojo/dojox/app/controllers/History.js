//>>built
define("dojox/app/controllers/History",["dojo/_base/lang","dojo/_base/declare","dojo/on","../Controller"],function(_1,_2,on,_3){return _2("dojox.app.controllers.History",_3,{constructor:function(_4){this.events={"startTransition":this.onStartTransition};this.inherited(arguments);this.bind(window,"popstate",_1.hitch(this,this.onPopState));},onStartTransition:function(_5){var _6=_5.detail.target;var _7=/#(.+)/;if(!_6&&_7.test(_5.detail.href)){_6=_5.detail.href.match(_7)[1];}history.pushState(_5.detail,_5.detail.href,_5.detail.url);},onPopState:function(_8){if(this.app.getStatus()!==this.app.lifecycle.STARTED){return;}var _9=_8.state;if(!_9){if(!this.app._startView&&window.location.hash){_9={target:(location.hash&&location.hash.charAt(0)=="#")?location.hash.substr(1):location.hash,url:location.hash};}else{_9={};}}var _a=_9.target||this.app._startView||this.app.defaultView;if(this.app._startView){this.app._startView=null;}var _b=_9.title||null;var _c=_9.url||null;if(_8._sim){history.replaceState(_9,_b,_c);}var _d=history.state;this.app.trigger("transition",{"viewId":_a,"opts":_1.mixin({reverse:false},_8.detail)});}});});